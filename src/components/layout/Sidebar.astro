---
const sections = [
  { id: 'firewall-for-ai', label: 'Firewall for AI', path: '/firewall-for-ai' },
  { id: 'images', label: 'Images', path: '/images' },
];
---

<aside class="sidebar">
  <div class="sidebar-title">Navigation</div>
  <ul class="sidebar-nav">
    {sections.map((section) => (
      <li>
        <a
          href={section.path}
          data-section={section.id}
          data-astro-prefetch
        >
          {section.label}
        </a>
      </li>
    ))}
  </ul>
</aside>

<style>
  .sidebar {
    width: 250px;
    flex-shrink: 0;
    background: var(--card-bg);
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-subtle);
    position: sticky;
    top: 20px;
    max-height: calc(100vh - 40px);
    overflow-y: auto;
  }

  .sidebar-title {
    font-size: 1.2em;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--text-primary);
  }

  .sidebar-nav {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-nav li {
    margin-bottom: 5px;
  }

  .sidebar-nav a {
    display: block;
    padding: 10px 14px;
    color: var(--text-secondary);
    text-decoration: none;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-size: 0.9em;
    font-weight: 500;
  }

  .sidebar-nav a:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
  }

  .sidebar-nav a.active {
    background: var(--cf-orange);
    color: white;
  }

  @media (max-width: 768px) {
    .sidebar {
      width: 100%;
      position: static;
      max-height: none;
    }
  }
</style>

<script>
  function updateActiveLink() {
    const links = document.querySelectorAll('[data-section]');
    const currentPath = window.location.pathname;

    // Determine current section from path
    let currentSection = 'firewall-for-ai';
    if (currentPath !== '/') {
      const pathParts = currentPath.split('/').filter(Boolean);
      if (pathParts.length >= 1) {
        currentSection = pathParts[0];
      }
    }

    // Update active states
    links.forEach((link) => {
      const section = link.getAttribute('data-section');
      if (section === currentSection) {
        link.classList.add('active');
      } else {
        link.classList.remove('active');
      }
    });
  }

  // Initial load
  document.addEventListener('DOMContentLoaded', updateActiveLink);

  // Update on view transitions
  document.addEventListener('astro:page-load', updateActiveLink);
</script>
