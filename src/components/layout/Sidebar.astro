---
const sections = [
  { id: 'overview', label: 'Overview' },
  { id: 'resources', label: 'Resources' },
  { id: 'configuration', label: 'Configuration' },
  { id: 'analytics', label: 'Analytics' },
  { id: 'caching', label: 'Caching' },
  { id: 'settings', label: 'Settings' },
];
---

<aside class="sidebar">
  <div class="sidebar-title">Navigation</div>
  <ul class="sidebar-nav">
    {sections.map((section) => (
      <li>
        <a
          href={`#${section.id}`}
          data-section={section.id}
          class={section.id === 'overview' ? 'active' : ''}
        >
          {section.label}
        </a>
      </li>
    ))}
  </ul>
</aside>

<style>
  .sidebar {
    width: 250px;
    flex-shrink: 0;
    background: var(--card-bg);
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-subtle);
    position: sticky;
    top: 20px;
    max-height: calc(100vh - 40px);
    overflow-y: auto;
  }

  .sidebar-title {
    font-size: 1.2em;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--text-primary);
  }

  .sidebar-nav {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .sidebar-nav li {
    margin-bottom: 5px;
  }

  .sidebar-nav a {
    display: block;
    padding: 10px 14px;
    color: var(--text-secondary);
    text-decoration: none;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-size: 0.9em;
    font-weight: 500;
  }

  .sidebar-nav a:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
  }

  .sidebar-nav a.active {
    background: var(--cf-orange);
    color: white;
  }

  @media (max-width: 768px) {
    .sidebar {
      width: 100%;
      position: static;
      max-height: none;
    }
  }
</style>

<script>
  const links = document.querySelectorAll('[data-section]');

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        const link = document.querySelector(`[data-section="${entry.target.id}"]`);
        if (link) {
          links.forEach(l => l.classList.remove('active'));
          if (entry.isIntersecting) {
            link.classList.add('active');
          }
        }
      });
    },
    { threshold: 0.3 }
  );

  links.forEach((link) => {
    const targetId = link.getAttribute('href');
    if (targetId) {
      const targetElement = document.getElementById(targetId.slice(1));
      if (targetElement) {
        observer.observe(targetElement);
      }
    }
  });

  links.forEach((link) => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const targetId = link.getAttribute('href');
      if (targetId) {
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
    });
  });
</script>
